# üìå –§–∏–Ω–∞–ª—å–Ω—ã–π TODO –ø—Ä–æ–µ–∫—Ç–∞ Barber SaaS (Multi‚ÄëTenant)
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2026-01-14  
**–¶–µ–ª—å —Ñ–∞–π–ª–∞:** –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –ø–æ –æ—Å—Ç–∞–≤—à–∏–º—Å—è –∑–∞–¥–∞—á–∞–º (roadmap + —Ä–µ–∞–ª—å–Ω—ã–µ –±–∞–≥–∏).

---

## ‚úÖ –£–∂–µ –∑–∞–∫—Ä—ã—Ç–æ (–ø–æ —Ñ–∞–∫—Ç—É –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
- **–≠—Ç–∞–ø 1**: –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚Äî –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –∑–∞–≤–µ—Ä—à—ë–Ω –≤ `STAGE_1_COMPLETE.md` (tenant-—Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á–∏—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞).
- **–≠—Ç–∞–ø 2**: Public-–º–æ–¥–µ–ª–∏/—Å—Ö–µ–º—ã/CRUD/seed ‚Äî –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ –∑–∞–≤–µ—Ä—à—ë–Ω –≤ `STAGE_2_COMPLETE.md`.
- **Public —Å—Ö–µ–º–∞ –∏ super-admin**: –ø–æ `TODO_FIXES.md` –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—É—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (ORM, webhooks, super_admin).
- **–ú—É–ª—å—Ç–∏-–±–æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –µ—Å—Ç—å `bot/bot_manager.py`, `bot/main.py`, middleware, –ø—Ä—è–º—ã–µ SQL –≤—Å—Ç–∞–≤–∫–∏/—á—Ç–µ–Ω–∏–µ –¥–ª—è tenant.

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Ä—è–¥ —Ñ–∞–π–ª–æ–≤ –≤ `md/` –≤—Å—ë –µ—â—ë –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å ¬´‚è≥ –í –æ–∂–∏–¥–∞–Ω–∏–∏¬ª, –Ω–æ –∫–æ–¥ —É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ/–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚Äî —ç—Ç–æ –Ω—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å (—Å–º. –∑–∞–¥–∞—á–∏ ‚Äú–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è‚Äù –Ω–∏–∂–µ).

---

## üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å)

### 1) Backend: `/api/clients` –ø–∞–¥–∞–µ—Ç 500 –≤ tenant (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è)
- [ ] **–ò—Å–ø—Ä–∞–≤–∏—Ç—å `web/backend/app/api/clients_tenant.py`**: —É–±—Ä–∞—Ç—å –∏–∑ SQL –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `car_brand/car_model/car_number/total_visits/total_amount`, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ `tenant_X.clients`.
  - **–°–∏–º–ø—Ç–æ–º**: `UndefinedColumnError: column c.car_brand does not exist` (–∏ —Ä–∞–Ω–µ–µ `total_visits`).
  - **–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**: –≤–∫–ª–∞–¥–∫–∞ ‚Äú–ö–ª–∏–µ–Ω—Ç—ã‚Äù –≤ –∞–¥–º–∏–Ω–∫–µ –∫–æ–º–ø–∞–Ω–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ 500, –¥–∞–Ω–Ω—ã–µ –≥—Ä—É–∑—è—Ç—Å—è.

### 2) –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç—É –≤ Telegram –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ (—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è)
- [ ] **–î–æ–≤–µ—Å—Ç–∏ –¥–æ ‚Äú–∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–∞‚Äù —Ü–µ–ø–æ—á–∫—É**: `PATCH /api/bookings/{id}` ‚Üí `send_booking_status_notification()` ‚Üí Telegram.
  - [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `telegram_id` –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ `tenant_X.users.telegram_id` –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.
  - [ ] –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ –ª–æ–≥–∏-–º–µ—Ç–∫–∏: `company_id`, `booking_id`, `user_id`, `telegram_id`, —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ Telegram.
  - [ ] –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ: **–±–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—ã–º** ‚Äî –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–∂–∞–ª `/start`, –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.
  - **–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**: –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ UI –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É, –∞ –≤ UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚Äú‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ‚Äù.

### 3) –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ (Telegram)
- [ ] **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –≤ –±–æ—Ç–µ** (—Ä–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äú–Ω–æ–≤–∞—è –∑–∞—è–≤–∫–∞‚Äù).
  - [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã–±–æ—Ä –∞–¥–º–∏–Ω–æ–≤ –∏–¥—ë—Ç –∏–∑ `tenant_X.users` –ø–æ `role='admin'` –∏ `telegram_id IS NOT NULL`.
  - **–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**: –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏.

---

## üü† –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

### 4) Multi‚Äëtenant backend: –ø—Ä–∏–≤–µ—Å—Ç–∏ CRUD –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É
- [ ] **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–ø–æ—Å–æ–± –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è tenant**:
  - [ ] `company_id` –±–µ—Ä—ë–º –∏–∑ JWT / query / middleware (–æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫).
  - [ ] –ù–µ –ø–ª–æ–¥–∏—Ç—å ‚ÄúSET search_path‚Äù –≤—Ä—É—á–Ω—É—é –≤ –∫–∞–∂–¥–æ–º endpoint, –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å `TenantMiddleware` (`web/backend/app/middleware/tenant.py`).
- [ ] **–ê—É–¥–∏—Ç CRUD –º–æ–¥—É–ª–µ–π** (–ø–æ —Ñ–∞–∫—Ç—É –ø–æ–≤–µ–¥–µ–Ω–∏—è, –Ω–µ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É):
  - [ ] bookings
  - [ ] users
  - [ ] clients
  - [ ] services
  - [ ] masters
  - [ ] posts/—Ä–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞
  - [ ] blocks/promocodes/promotions/broadcasts/settings
  - **–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**: –Ω–µ—Ç 500/UndefinedColumn, –≤—Å–µ —Å–ø–∏—Å–∫–∏/—Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –≤ tenant –±–µ–∑ —Ä—É—á–Ω—ã—Ö —Ñ–∏–∫—Å–æ–≤.

### 5) Celery: –ø—Ä–∏–≤–µ—Å—Ç–∏ –∑–∞–¥–∞—á–∏ –∫ —Ä–∞–±–æ—á–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (–∏–ª–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è)
- [ ] –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è/—Ä–∞—Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ Celery –∏–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–∑ API.
  - [ ] –ï—Å–ª–∏ —á–µ—Ä–µ–∑ Celery: –ø–æ–¥–Ω—è—Ç—å `celery-worker` –∏ `celery-beat`, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç/–∫–æ–Ω—Ñ–∏–≥–∏, –ø—Ä–æ–≥–Ω–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏.
  - [ ] –ï—Å–ª–∏ –±–µ–∑ Celery: —É–±—Ä–∞—Ç—å –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥/–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏.

---

## üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ñ—É–Ω–∫—Ü–∏–∏ ‚Äú–ø–æ –ø–ª–∞–Ω—É‚Äù, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è MVP)

### 6) –†–∞—Å—Å—ã–ª–∫–∏ (Broadcasts)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É —Ä–∞—Å—Å—ã–ª–æ–∫ —á–µ—Ä–µ–∑ Telegram (—Å–º. `md/REMAINING_TASKS.md`).
  - [ ] –û—á–µ—Ä–µ–¥—å/–±–∞—Ç—á–∏–Ω–≥/–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram.
  - [ ] –£—á—ë—Ç –æ—à–∏–±–æ–∫ (blocked/forbidden), —Å—á—ë—Ç—á–∏–∫–∏ `total_sent/total_errors`.

### 7) –ê–≤—Ç–æ‚Äë–ª–∏—Å—Ç‚Äë–Ω–∞—Ä—è–¥—ã –º–∞—Å—Ç–µ—Ä–∞–º (—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∞–π–¥–∂–µ—Å—Ç)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –ª–∏—Å—Ç-–Ω–∞—Ä—è–¥–∞ –º–∞—Å—Ç–µ—Ä–∞–º (–µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–∫—Ç—É–∞–ª–µ–Ω –¥–ª—è —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã).

### 8) ‚Äú–ù–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –∑–∞ 5 –º–∏–Ω—É—Ç‚Äù ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º
- [ ] –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–º–µ–Ω–Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ): –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É, –º–µ—Ö–∞–Ω–∏–∑–º ‚Äú—É–∂–µ —É–≤–µ–¥–æ–º–∏–ª–∏‚Äù.

---

## üß™ –≠—Ç–∞–ø 11: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º)
- [ ] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–æ–≤ `web/backend/tests/` –∏ `bot/tests/`.
- [ ] Unit: —Å–µ—Ä–≤–∏—Å—ã (company/subscription/payment/tenant), —Å—Ö–µ–º—ã.
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ: tenant –∏–∑–æ–ª—è—Ü–∏—è, search_path/middleware, –æ—Å–Ω–æ–≤–Ω—ã–µ CRUD.
- [ ] E2E (–º–∏–Ω–∏–º—É–º): —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –≤—Ö–æ–¥ ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ ‚Üí —Å–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å–∞ ‚Üí Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

---

## üöÄ –≠—Ç–∞–ø 12: –î–µ–ø–ª–æ–π
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å `.env.production` –∏ —à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤.
- [ ] –û—Ç–¥–µ–ª—å–Ω—ã–π compose –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (`docker-compose.prod.yml`).
- [ ] Nginx + SSL + healthchecks.
- [ ] –ë—ç–∫–∞–ø—ã –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

---

## üìö –≠—Ç–∞–ø 13: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ ‚Äú—Ñ–∞–∫—Ç–æ–º –∫–æ–¥–∞‚Äù)
- [x] –ü—Ä–∏–≤–µ—Å—Ç–∏ `md/*.md` —Å—Ç–∞—Ç—É—Å—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é (–≥–¥–µ ‚Äú‚è≥‚Äù, –Ω–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ). *(–≤—ã–ø–æ–ª–Ω–µ–Ω–æ: 2026-01-14)*
- [ ] –£–¥–∞–ª–∏—Ç—å/–ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ ‚Äúautoservice_*‚Äù –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–¥ —Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã.
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `README.md` (–∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å, —á—Ç–æ –≥–¥–µ, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å).

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É
- [ ] –ü—Ä–æ–≥–Ω–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–≤—å—é: **Bugbot** –∏–ª–∏ **CodeRabbit** –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º (–æ—Å–æ–±–µ–Ω–Ω–æ `bookings.py`, `clients_tenant.py`, bot handlers).

